# Polyfill
- 말 그대로 구현이 누락된 새로운 기능을 메꿔주는(fill in) 역할
- 변경된 표준을 준수할 수 있게 기존 함수의 동작 방식을 수정하거나, 새롭게 구현한 함수의 스크립트
- 폴리필은 본질적으로 자바스크립트 개발자에게 모든 브라우저에서 작동하는 단일 공통 API를 제공할 수 있도록 브라우저 별 해결 방법을 모아 둔 것
- 최신 브라우저는 대부분 표준 의미 체계에 따라 광범위한 API 세트를 구현하기 때문에 브라우저별 구현을 처리하기 위해 폴리필을 사용하는 경우가 줄어듦
- 기능을 지원하지 않는 웹 브라우저에서 원하는 기능을 구현할 수 있으나, 폴리필 플러그인 로드 때문에 시간과 트래픽이 늘어나고,<br/> 브라우저별 기능을 추가하는 것 때문에 코드가 매우 길어지고, 성능이 많이 저하된다는 단점 존재

<br/>

## 필요한 Polyfill 스크립트만 선택적으로 불러오는 방법
### Babel의 @babel/preset-env 스마트 프리셋 이용
- 스마트 프리셋은 이미 정의된 브라우저 목록에 따라 자동으로 필요없는 폴리필 제거 
- 이 경우에도 최신 브라우저는 오래된 브라우저를 위한 폴리필을 내려받음

### User-agent에 따라 동적으로 스크립트 생성
- 최신 브라우저에서 내려받는 폴리필 스크립트를 거의 없게 만들 수 있음

<br/>

## 예시
### core js 
- `import 'core-js/actual';`
- 표준적으로 사용되는 다양한 폴리필 제공
- 특정 기능의 폴리필만 사용하는 것도 가능

### Polyfill.io 
- 기능이나 사용자의 브라우저에 따라 폴리필 스크립트를 제공해주는 서비스

### HTML5 shiv
- 인터넷 익스플로러 9 이하에서 시맨틱 태그를 지원

### CSS3 PIE
- 인터넷 익스플로러 9 이하에서 CSS3 둥근 모서리(border-radius) 속성을 지원

### FlashCanvas
- 캔버스를 지원하지 않는 인터넷 익스플로러 8 이하에서 HTML5 캔버스를 인터넷 익스플로러 8이하에 맞는 플래시 오브젝트로 바꾸어 나타냄

### MediaElement.js
- audio/video 태그를 지원하지 않는 브라우저에서, 해당 태그를 플래시로 바꾸어 표시

### Flexie
- Flex를 지원하지 않는 구형 브라우저에서 Flex CSS 옵션을 지원

<br/>

## 관련 최근 이슈
- Polyfill.js는 오래된 브라우저 지원을 위한 오픈 소스 라이브러리로 전 세계 10만개 이상의 사이트에서 사용 중
- 2024년 2월, 중국 기업 펀눌(Funnull)이 Polyfill.io의 도메인과 Github 계정을 인수한 후<br/> 해당 도메인의 자바스크립트 라이브러리(Polyfill.js)를 수정해 모바일 기기에 악성 코드 주입. 

### 공격 내용
- 가짜 구글 애널리틱스 도메인(www. googie-anaiytics .com)을 통해 모바일 사용자를 스포츠 배팅 사이트로 리디렉션하여 사용자의 개인정보와 데이터를 탈취 유도
- 해당 공격은 HTTP 헤더를 기반으로 동적으로 생성된 코드가 특정 모바일 기기에서 특정 시간에만 활성화되며, <br/>
관리자 사용자나 웹 분석 서비스가 감지되면 실행을 지연시키도록 설계돼 있어 리버스 엔지니어링(reverse engineering)기법 조차 방해하는 특징
- 피해가 커지자 구글은 6월 25일에 Polyfill.io 도메인을 사용하는 전자상거래 사이트의 구글 광고를 차단하기 시작
- 폴리필의 코드 제작자조차도 최신 브라우저에서는 더 이상 폴리필이 필요하지 않으니 이를 사용하지 말라고 권장

### 생각할 점
- 오픈 소스 프로젝트가 인수되면서 발생할 수 있는 보안 위험을 잘 보여주는 사례로 많은 사이트에서 사용되는 라이브러리일수록 피해가 크다는 것을 인지해야 함
- Fastly와 Cloudflare 같은 신뢰할 수 있는 대안을 사용하는 것이 중요
- 최신 브라우저 지원이 충분하다면 Polyfill.js 사용 중단을 고려
- CSP 모니터링 서비스와 같은 보안 도구를 사용하여 코드 변경 사항을 실시간으로 모니터링하는 것이 좋음

<br/>

## 참고자료 
- https://ko.javascript.info/Polyfills
- https://developer.mozilla.org/ko/docs/Glossary/Polyfill
- https://ko.wikipedia.org/wiki/%ED%8F%B4%EB%A6%AC%ED%95%84_(%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D)
- https://m.boannews.com/html/detail.html?idx=131258
- https://news.hada.io/topic?id=15522