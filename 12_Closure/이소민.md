## 1. 클로저
- 클로저는 함수와 그 함수가 선언된 렉시컬 환경과의 조합
- 클로저는 함수가 선언될 때의 렉시컬 환경을 기억하고 이를 유지하면서 함수를 호출할 수 있는 기능
- 모든 함수는 렉시컬 환경을 가지며 이를 기반으로 클로저를 형성하기 때문에 자바스크립트에서 모든 함수는 자연스럽게 클로저가 된다.

<br/>
<br/>

### 1-1. 렉시컬 스코프 ? 
    "lexical"이란, 어휘적 범위 지정(lexical scoping) 과정에서 변수가 어디에서 사용 가능한지 알기 위해 그 변수가 소스코드 내 어디에서 선언되었는지 고려한다는 것을 의미한다. 단어 "lexical"은 이런 사실을 나타낸다. 중첩된 함수는 외부 범위(scope)에서 선언한 변수에도 접근할 수 있다.

- 렉시컬 스코프(정적 스코프)란 함수를 어디서 호출했는지가 아니라 함수를 어디서 정의했는지에 따라 상위 스코프를 결정하는 것이다.
- 만약 함수를 어디에서 호출했느냐에 따라서 접근할 수 있는 유효 범위가 달라진다면 다이나믹 스코프(동적 스코프)다.

<br/>
<br/>

### 1-2. 렉시컬 스코프와 `[[Environment]]` 프로퍼티
- 렉시컬 스코프가 가능하려면 상위 스코프를 기억해야하는데 이 때 함수는 `[[Environment]]`라는 숨겨진 프로퍼티를 사용하여 자신이 정의된 환경, 즉 상위 스코프의 참조를 저장한다. 
- `[[Environment]]` 프로퍼티는 함수 객체에만 존재하는 숨겨진 프로퍼티로, 일반 객체는 렉시컬 환경과 직접적인 관련이 없기 때문에 `[[Environment]]` 프로퍼티를 갖지 않는다.
- 함수 객체의 숨겨진 프로퍼티 `[[Environment]]`에 저장된 현재 실행중인 실행 컨텍스트의 렉시컬 환경의 참조가 바로 상위 스코프다. 또한 자신이 호출되었을 때 생성될 함수 렉시컬 환경의 '외부 렉시컬 환경에 대한 참조'에 저장될 참조값이다. 
- 함수 객체는 `[[Environment]]`에 저장한 렉시컬 환경의 참조, 즉 상위 스코프를 자신이 존재하는 한 기억한다. 
- 함수가 호출되어 실행 컨텍스트가 생성될 때마다 새로운 렉시컬 환경이 생성되는데, 이때 해당 함수의 `[[Environment]]`에 저장된 참조값이 외부 렉시컬 환경에 대한 참조로 할당되어 새로운 렉시컬 환경의 outer 프로퍼티에 저장된다. 이렇게 함으로써 클로저를 구현할 수 있게 된다.

<br/>
<br/>

### 1-3. 예제
```js
function 더하기함수공장(초기값){
    function 덧셈(숫자){
        return 초기값 + 숫자;
    } 
    // '덧셈'이라는 함수가 만들어지는 시점에서의 부모함수 '더하기함수공장'이 가지고 있는 스코프를 '덧셈'이라는 함수가 동봉하여 가지고 있다. 그래서 언제든지 호출하면 '더하기함수공장' 스코프에 접근할 수 있다.
    return 덧셈;
}

let 더하기2 = 더하기함수공장(2)
console.log(더하기1(1)) //3 
console.log(더하기1(2)) //4

let 더하기3 = 더하기함수공장(3)
console.log(더하기1(1)) //4
console.log(더하기1(2)) //5

// 외부함수인 '더하기함수공장'보다 중첩함수인 '덧셈'이 더 오래 유지되는 경우 중첩함수 '덧셈'은 이미 생명주기가 종료한 외부함수 '더하기함수공장'의 변수를 참조할 수 있다는 것을 알 수 있다. 이러한 중첩함수를 '클로저'라고 한다.
```
<br/>
<br/>

### 1-4. 모든 함수는 클로저 ? 맞는 말인데 틀린 말
자바스크립트의 모든 함수는 상위 스코프를 기억하므로 이론적으로 모든 함수는 클로저이지만, 실제로 모든 함수를 클로저라고 하지 않는다.

    - 상위 스코프의 어떤 식별자도 참조하지 않는 함수는 클로저가 아니다.
    - 중첩함수가 클로저라도 외부 함수보다 일찍 소멸될 경우 클로저의 본질에 부합하지 않는다.

**클로저는 중첩함수가 상위 스코프의 식별자를 참조하고 있고 중첩 함수가 외부 함수보다 더 오래 유지되는 경우에 한정하는 것이 일반적이다**

<br/>
<br/>

### [참고 자료]
자바스크립트 딥다이브 - 클로저 <br/>
MDN - 클로저 https://developer.mozilla.org/ko/docs/Web/JavaScript/Closures <br/>
생활코딩 - https://www.youtube.com/watch?v=bwwaSwf7vkE<br/>
모던 자바스크립트 튜토리얼 - https://ko.javascript.info/closure#ref-739<br/>

